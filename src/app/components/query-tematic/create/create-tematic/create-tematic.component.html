<!--{{TematicForm.value | json}}-->

<div class="mainscreen">
       <div class="card">
          <div class="rightside">
            <form [formGroup]="TematicForm">
              <p>Tematic Name</p>
              <input type="text" class="inputbox" formControlName="tematicName" #tematic/>

          <div formGroupName="query">
              <p>Layer Name</p>
              <select class="inputbox" formControlName="layerName">
                  <option *ngFor="let item of layers" [value]="item">{{item}}</option>

              </select>

              <br><br>
              <h3>Query</h3> <hr>

              <div class="expcvv">
                <button class="button2" (click)="addCondition('And')">AND</button>

                <button class="button2" (click)="addCondition('Or')">OR</button>
              </div>


              <div formArrayName="conditions">
              <table class="table table-striped table-bordered table-head">
                <thead>
                  <th>
                    <p class="text-center">Column</p>
                  </th>
                  <th>
                    <p class="text-center">Operator</p>
                  </th>
                  <th>
                    <p class="text-center">Value</p>
                  </th>
                </thead>

                <tbody [formGroupName]="i" *ngFor="let item of conditions.controls; let i = index">
                  <div *ngIf="item.get('logicOperator')?.value">
                    {{item.get('logicOperator')?.value | uppercase}}
                  </div>
                  <tr>
                  <td class="col-md-3">
                    <select class="inputbox" formControlName="columnName" (change)="setOperators(i)">
                      <option *ngFor="let col of columns" [value]="col">{{col}}</option>
                    </select>
                  </td>
                  <td class="col-md-3">
                    <select class="inputbox" formControlName="_operator">
                      <option *ngFor="let op of operators[i]" [value]="op">{{op}}</option>
                    </select>
                  </td>
                  <td>
                    <input class="inputbox"  formControlName="value" />
                  </td>
                  <td>
                    <i class="far fa-trash-alt fa-lg trash" (click)="removeCondition(i)"></i>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>

            <br><hr><br>
              <p>Apply Style to this query</p>
              <select class="inputbox" formControlName="styleName">
                <option *ngFor="let style of styles" [value]="style.name">{{style.name}}</option>
              </select>
          </div>

              <p></p>
              <button type="submit" (click)="addQuery()" [disabled]="TematicForm.invalid" class="button1 btn btn-success btn-lg btn-block">AddQuery</button>
            </form>
            <br>
            <div class="expcvv">

            <button class="button1 btn btn-success btn-lg btn-block" (click)="saveTematic()" [disabled]="this.tematicService.tematicQueries.length<1">Create Tematic</button>
            <button class="button1 btn btn-success btn-lg btn-block marginButton">Cancel</button>
          </div>
        </div>
        </div>
      </div>

