<div class="jumbtron">
  <div>
  <h2><b>Create new Category Tematic</b></h2>
  </div>
  <hr>
  <div class="row">
    <div class="col-md-6">
<!-- {{CategoryTematicForm.value | json}} -->

<div class="mainscreen">
  <div class="card">
     <div class="rightside">
       <form [formGroup]="CategoryTematicForm">
         <p>Tematic Name</p>
         <input type="text" class="inputbox" formControlName="tematicName" #tematic/>

     <div formGroupName="query">
         <p>Layer Name</p>
         <select class="inputbox" formControlName="layerName">
             <option *ngFor="let item of layers" [value]="item">{{item}}</option>

         </select>

         <br><br>
         <h3>Query</h3> <hr>

         <div class="expcvv">
           <button class="button2" (click)="addCondition('And')">AND</button>

           <button class="button2" (click)="addCondition('Or')">OR</button>
         </div>


         <div formArrayName="conditions">
         <table class="table table-striped table-bordered table-head">
           <thead>
             <th>
               <p class="text-center">Column</p>
             </th>
             <th>
             </th>
             <th>
               <p class="text-center">Category</p>
             </th>
           </thead>

           <tbody [formGroupName]="i" *ngFor="let item of conditions.controls; let i = index">
             <div *ngIf="item.get('logicOperator')?.value">
               {{item.get('logicOperator')?.value | uppercase}}
             </div>
             <tr>
             <td class="col-md-3">
               <select class="inputbox" formControlName="columnName" (change)="setCategories(i)">
                 <option *ngFor="let col of columns" [value]="col">{{col}}</option>
               </select>
             </td>
             <td class="col-md-1 text-center">
               <b>==</b>
             </td>
             <td class="col-md-8">
              <select class="inputbox" formControlName="value">
                <option *ngFor="let cat of categories[i]" [value]="cat">{{cat}}</option>
              </select>
             </td>
             <td>
               <i class="far fa-trash-alt fa-lg trash" (click)="removeCondition(i)"></i>
             </td>
           </tr>
           </tbody>
         </table>
       </div>

       <br><hr><br>
         <p>Apply Style to this query</p>
         <select class="inputbox" formControlName="styleName">
           <option *ngFor="let style of styles" [value]="style.name">{{style.name}}</option>
         </select>
     </div>

         <p></p>
         <button type="submit" (click)="addQuery()" [disabled]="CategoryTematicForm.invalid" class="button1 btn btn-success btn-lg btn-block">AddQuery</button>
       </form>
       <br>
       <div class="expcvv">

       <button class="button1 btn btn-success btn-lg btn-block" (click)="saveTematic()" [disabled]="this.tematicService.tematicQueries.length<1">Create Tematic</button>
       <button class="button1 btn btn-success btn-lg btn-block marginButton">Cancel</button>
     </div>
   </div>
   </div>
 </div>


    </div>



<!--LIST QUERIES-------------------------------------------------------------------------------------------->
    <div class="col-md-6">

<div class="card2 mainscreen2">

  <table class="table table-sm table-bordered table-striped table-head">
    <thead>
        <th>
          <p class="text-center"><b>Layer</b></p>
        </th>
        <th>
          <p class="text-center"><b>Query</b></p>
        </th>
        <th>
          <p class="text-center"><b>Style</b></p>
        </th>
        <th>
          <p class="text-center"></p>
        </th>
      </thead>

    <tbody>
    <tr *ngFor="let _query of tematicService.tematicQueries; let i = index">
      <td class="col-md-2 text-center">{{_query.layerName}}</td>
      <td class="col-md-4">
        <div *ngFor="let condition of _query.conditions">
          <b *ngIf="condition.logicOperator">{{condition.logicOperator + ' ' | uppercase}}</b>
          {{condition.columnName + ' '}} {{condition._operator | uppercase}} {{' ' + condition.value}}<br>
        </div>
      </td>
      <td class="col-md-2 text-center">
        {{_query.styleName}}
      </td>
      <td class="col-md-2 text-center">
        <i class="far fa-edit fa-lg edit2" (click)="editQuery(i)"></i>

        <i class="far fa-trash-alt fa-lg trash2" (click)="deleteQuery(i)"></i>
      </td>
    </tr>
  </tbody>
  </table>

</div>

    </div>
  </div>
</div>
